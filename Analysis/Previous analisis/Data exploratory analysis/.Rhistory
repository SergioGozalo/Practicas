RStudio.Version()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = setwd("/Users/Usuario/Desktop/Bioinformatica/Practicas/Practicas/Analysis/"))
library("vegan")
library("ggplot2")
library("tidyr")
library("plyr")
library("dplyr")
library("reshape2")
library("randomcoloR")
#ICM
f_kegg_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_KEGG.ko.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
f_kegg_scgt <- t(f_kegg_scg)
f_kegg_mgn <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_KEGG.ko.lengthNorm.metaGsizeNorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
#ICM
f_kegg_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_KEGG.ko.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
f_kegg_scgt <- t(f_kegg_scg)
f_kegg_mgn <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_KEGG.ko.lengthNorm.metaGsizeNorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
f_kegg_mgnt <- t(f_kegg_scg)
icm_cog_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_COG.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
icm_pfam_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_pfam.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
otu_mitags <- (read.delim("functional.tables/otu_table97.txt", header = TRUE, sep = "\t"))
otu_mitags$OTUId <- NULL
otu_mitags <- t(otu_mitags)
kegg_acc <- specaccum(f_kegg_mgnt, method = "exact", permutations = 1000)
kegg_acc <- specaccum(f_kegg_mgnt, method = "exact", permutations = 1000)
plot(kegg_acc)
kegg_acc <- specaccum(kegg_ss, method = "exact", permutations = 1000)
kegg_ss <- rrarefy(f_kegg_mgnt, min(rowSums(f_kegg_mgnt)))
f_kegg_mgn <- as.data.frame(f_kegg_mgn)
f_kegg_mgn[,1:50] <- sapply(f_kegg_mgn[, c(1:50)], as.integer)
length(f_kegg_mgn)
richness <- estimateR(f_kegg_mgn)
f_kegg_mgnt <- as.data.frame(f_kegg_mgnt)
f_kegg_mgnt[,1:6965] <- sapply(f_kegg_mgnt[, c(1:6965)], as.integer)
length(f_kegg_mgnt)
richnesst <- estimateR(f_kegt)
kegg_ss <- rrarefy(f_kegg_mgnt, min(rowSums(f_kegg_mgnt)))
kegg_rare <- rarefaction(kegg_ss)
kegg_acc <- specaccum(kegg_ss, method = "exact", permutations = 1000)
plot(kegg_acc)
kegg_ss
min(rowSums(f_kegg_mgnt))
kegg_acc <- specaccum(f_kegg_mgnt, method = "exact", permutations = 1000)
kegg_acc <- specaccum(f_kegg_mgnt, method = "exact", permutations = 1000)
plot(kegg_acc)
kegg_acc <- specaccum(f_kegg_mgnt, method = "exact", permutations = 1000)
kegg_acc <- specaccum(kegg_ss, method = "exact", permutations = 1000)
plot(kegg_acc)
kegg_acc <- specaccum(f_kegg_mgnt, method = "exact", permutations = 1000)
plot(kegg_acc)
f_keg <- as.data.frame(f_kegg_scg)
f_keg[,1:50] <- sapply(f_keg[, c(1:50)], as.integer)
length(f_keg)
f_kegt <- as.data.frame(f_kegg_scgt)
f_kegt[,1:6965] <- sapply(f_kegt[, c(1:6965)], as.integer)
length(f_kegt)
kegg_ss <- rrarefy(f_kegt, min(rowSums(f_kegt)))
kegg_ss <- rrarefy(f_kegt, min(rowSums(f_kegt)))
kegg_acc <- specaccum(kegg_ss, method = "exact", permutations = 1000)
plot(kegg_acc)
library("vegan")
library("ggplot2")
library("tidyr")
library("plyr")
library("dplyr")
library("reshape2")
library("randomcoloR")
#ICM
f_kegg_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_KEGG.ko.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
f_kegg_scgt <- t(f_kegg_scg)
f_kegg_mgn <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_KEGG.ko.lengthNorm.metaGsizeNorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
f_kegg_mgnt <- t(f_kegg_scg)
icm_cog_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_COG.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
icm_pfam_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_pfam.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
otu_mitags <- (read.delim("functional.tables/otu_table97.txt", header = TRUE, sep = "\t"))
otu_mitags$OTUId <- NULL
otu_mitags <- t(otu_mitags)
f_keg <- as.data.frame(f_kegg_scg)
f_keg[,1:50] <- sapply(f_keg[, c(1:50)], as.integer)
length(f_keg)
f_kegt <- as.data.frame(f_kegg_scgt)
f_kegt[,1:6965] <- sapply(f_kegt[, c(1:6965)], as.integer)
length(f_kegt)
kegg_acc <- specaccum(f_kegg_scg, method = "exact", permutations = 1000)
plot(kegg_acc)
kegg_acc <- specaccum(f_kegg_scgt, method = "exact", permutations = 1000)
kegg_acc <- specaccum(f_kegg_scgt, method = "exact", permutations = 1000)
plot(kegg_acc)
f_kegt <- as.data.frame(f_kegg_scgt)
f_kegt[,1:6965] <- sapply(f_kegt[, c(1:6965)], as.integer)
length(f_kegt)
kegg_acc1 <- specaccum(f_kegg_scgt, method = "exact", permutations = 1000)
plot(kegg_acc1)
kegg_ss <- rrarefy(f_kegg_scgt, min(rowSums(f_kegg_scgt)))
kegg_ss <- rrarefy(f_kegt, min(rowSums(f_kegt)))
kegg_acc2 <- specaccum(kegg_ss, method = "exact", permutations = 1000)
plot(kegg_acc2)
#ICM
f_kegg_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_KEGG.ko.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
f_kegg_scgt <- t(f_kegg_scg)
f_kegg_mgn <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_KEGG.ko.lengthNorm.metaGsizeNorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
f_kegg_mgnt <- t(f_kegg_mgn)
icm_cog_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_COG.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
icm_pfam_scg <- (read.table("functional.tables/EMOSE-GC_ICM_250bp_pfam.lengthNorm.SCGnorm.counts.tbl", header = TRUE, sep = "\t", row.names = 1))
otu_mitags <- (read.delim("functional.tables/otu_table97.txt", header = TRUE, sep = "\t"))
otu_mitags$OTUId <- NULL
otu_mitags <- t(otu_mitags)
kegg_acc1.1 <- specaccum(f_kegg_mgnt, method = "exact", permutations = 1000)
kegg_acc1.1 <- specaccum(f_kegg_mgnt, method = "exact", permutations = 1000)
plot(kegg_acc1.1)
f_kegg_mgnt <- as.data.frame(f_kegg_mgnt)
f_kegg_mgnt[,1:6965] <- sapply(f_kegg_mgnt[, c(1:6965)], as.integer)
kegg_ss2 <- rrarefy(f_kegg_mgnt, min(rowSums(f_kegg_mgnt)))
kegg_acc2.2 <- specaccum(kegg_ss2, method = "exact", permutations = 1000)
plot(kegg_acc2.2)
min(rowSums(f_kegg_mgnt))
rowSums(f_kegg_mgnt)
rowSums(f_kegt)
plot(kegg_acc2)
rowSums(f_kegt)
plot(kegg_acc2.2)
plot(kegg_acc2)
