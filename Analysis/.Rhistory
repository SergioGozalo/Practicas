eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
#ICM
icm <- icm %>%
select(1,4,14,15,22)
eth
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
eth
icm
colnames(icm) <- c("ID", "Taxonomy", "Completeness", "Contamination", "N50")
icm
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = setwd("/Users/Usuario/Desktop/Bioinformatica/Practicas/Practicas/Analysis/"))
library("tidyr")
library("dplyr")
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
#ICM
icm <- icm %>%
select(1,4,14,15,22)
colnames(icm) <- c("ID", "Taxonomy", "Completeness", "Contamination", "N50")
icm
eth$type <- "eth"
eth
icm$type <- "icm"
icm
library("ggplot2")
icmplot <- ggplot(icm, aes(x = Completeness)) + geom_bar()
icmplot
icmplot <- ggplot(icm, aes(y = Completeness)) + geom_bar()
icmplot
icmplot <- ggplot(icm, aes(y = Completeness, y = ID)) + geom_bar()
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_bar()
icmplot
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col()
icmplot
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1))
icmplot
eth
icm <- icm[-1]
icm
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
eth$type <- "eth"
#ICM
icm <- icm %>%
select(1,4,14,15,22)
colnames(icm) <- c("ID", "Taxonomy", "Completeness", "Contamination", "N50")
icm$type <- "icm"
icm <- icm[-1,]
icm
eth
icm
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1))
icmplot
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + stat_summary(
geom = "point",
fun.y = "mean",
col = "black",
size = 3,
shape = 24,
fill = "red"
)
icmplot
icmmean <- sum(icm$Completeness)/nrows(icm)
icmmean <- sum(icm$Completeness)/nrow(icm)
icmmean
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_abline(icmean)
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_abline(icmmean)
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_hline(yintercept = icmmean)
icmplot
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_hline(yintercept = icmmean, col = "red")
icmplot
ethmean <-  sum(eth$Completeness)/nrow(eth)
ethmean <-  sum(eth$Completeness)/nrow(eth)
eth$Completeness
sum(eth$Completeness)
ethmean <-  sum(as.integer(eth$Completeness))/nrow(eth)
sum(as.integer(eth$Completeness))
as.integer(eth$Completeness)
typeof(eth$Completeness)
ethmean <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethmean
as.numeric(eth$Completeness)
eth <- eth %>%
mutate(Completeness = as.numeric(Completeness),
Contamination = as.numeric(Contamination),
N50 = as.numeric(N50))
eth
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
eth$Completeness
icm$Completeness
eth$Completeness
eth <- eth %>%
mutate(Completeness = as.numeric(gsub(",","",Completeness,fixed=TRUE)),
Contamination = as.numeric(Contamination),
N50 = as.numeric(N50))
eth
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
eth
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
eth <- eth %>%
mutate(Completeness = as.numeric(gsub(",",".",Completeness,fixed=TRUE)),
Contamination = as.numeric(Contamination),
N50 = as.numeric(N50))
eth
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
eth <- eth %>%
mutate(Completeness = as.numeric(gsub(",",".",Completeness,fixed=TRUE)),
Contamination = as.numeric(gsub(",",".",Contamination,fixed=TRUE)),
N50 = as.numeric(gsub(",",".",N50,fixed=TRUE)))
eth$type <- "eth"
#ICM
icm <- icm %>%
select(1,4,14,15,22)
colnames(icm) <- c("ID", "Taxonomy", "Completeness", "Contamination", "N50")
icm$type <- "icm"
icm <- icm[-1,]
eth
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
eth
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
eth
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
eth <- eth %>%
distinct(eth[13], .keep_all = TRUE) %>%
select(1,4,5,10, 16)
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
eth <- eth %>%
mutate(Completeness = as.numeric(gsub(",",".",Completeness,fixed=TRUE)),
Contamination = as.numeric(gsub(",",".",Contamination,fixed=TRUE)),
N50 = as.numeric(gsub(",",".",N50,fixed=TRUE)))
eth$type <- "eth"
#ICM
icm <- icm %>%
select(1,4,14,15,22)
colnames(icm) <- c("ID", "Taxonomy", "Completeness", "Contamination", "N50")
icm$type <- "icm"
icm <- icm[-1,]
ethmean <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethmean
ethmean <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethplot <- ggplot(eth, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_hline(yintercept = ethmean, col = "red")
ethplot
icmmean <- sum(icm$Completeness)/nrow(icm)
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_hline(yintercept = icmmean, col = "red")
icmplot
eth
ethmean <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethplot <- ggplot(eth, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_hline(yintercept = ethmean, col = "red") + labs(x = NULL)
ethplot
icmmean <- sum(icm$Completeness)/nrow(icm)
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_hline(yintercept = icmmean, col = "red") + labs(x=NULL)
icmplot
ethmean <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethplot <- ggplot(eth, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_hline(yintercept = ethmean, col = "red") + labs(x = NULL)
ethplot
icmmean <- sum(icm$Completeness)/nrow(icm)
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_text(size = 5, angle = 90, vjust = 0.5, hjust=1)) + geom_hline(yintercept = icmmean, col = "red") + labs(x=NULL)
icmplot
ethmean <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethplot <- ggplot(eth, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmean, col = "red")
ethplot
icmmean <- sum(icm$Completeness)/nrow(icm)
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmean, col = "red")
icmplot
ethmean <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethplot <- ggplot(eth, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmean, col = "red") + ggtitle("ETH Completeness")
ethplot
icmmean <- sum(icm$Completeness)/nrow(icm)
icmplot <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmean, col = "red") + ggtitle("ICM Completeness")
icmplot
#ETH
ethmeanco <-  sum(as.numeric(eth$Contamination))/nrow(eth)
ethplotco <- ggplot(eth, aes(y = Contamination, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanco, col = "red") + ggtitle("ETH Contamination")
ethplotco
#ICM
icmmeanco <- sum(icm$Contamination)/nrow(icm)
icmplotco <- ggplot(icm, aes(y = Contamination, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanco, col = "red") + ggtitle("ICM Contamination")
icmplotco
#ETH
ethmeann <-  sum(as.numeric(eth$Contamination))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = Contamination, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanco, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanco, col = "red") + ggtitle("ICM N50")
icmplotn
icmmeann
#ETH
ethmeann <-  sum(as.numeric(eth$Contamination))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = Contamination, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanco, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanco, col = "red") + ggtitle("ICM N50")
icmplotn
icm
eth
icm
#ETH
ethmeann <-  sum(as.numeric(eth$Contamination))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = Contamination, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanco, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanco, col = "red") + ggtitle("ICM N50")
icmplotn
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanco, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanco, col = "red") + ggtitle("ICM N50")
icmplotn
icmmeann
ethmeann
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanco, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanco, col = "red") + ggtitle("ICM N50")
icmplotn
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icm
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icm$N50
icm
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50") + ylim(4000)
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50") + ylim(0, 4000)
icmplotres
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50") + ylim(0, 40000)
icmplotres
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50") + ylim(0, 40000)
icmplotres
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50") + ylim(0, 50000)
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50") + ylim(0, 50000)
icmplotres
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50") + ylim(0, 100000)
icmplotres
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50 (no outliers)") + ylim(0, 100000)
icmplotres
#ETH
representative <- distinct(eth[13])
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
representative <- distinct(eth[13])
representative
representative <- representative %>%
separate(V1, c(NA, "Path"), ".fa")
representative <- representative %>%
separate( c(NA, "Path"), ".fa")
typeof(representative)
representative <- strsplit(representative, ".fa")
representative <- strsplit(representative, ".")
representative <- strsplit(representative, ".")[[â™¦1]]
typeof(representative)
#ETH
representative <- as.dataframe(distinct(eth[13]))
#ETH
representative <- as.data.frame(distinct(eth[13]))
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
representative <- as.data.frame(distinct(eth[13]))
typeof(representative)
representative
representative <- strsplit(representative, ".")[[1]]
representative
representative <- representative %>%
separate(Representative.MAG, c(NA, "Path"), ".fa")
representative
#ETH
representative <- as.data.frame(distinct(eth[13]))
representative <- representative %>%
separate(Representative.MAG, c("a", "Path"), ".fa")
representative
#ETH
representative <- as.data.frame(distinct(eth[13]))
representative <- representative %>%
separate(Representative.MAG, c("Rep", NA), ".fa")
representative
eth
eth2 <- subset(eth, MAG.Id %in% representative)
eth2
eth2 <- subset(eth, MAG.Id %in% representative, .keep_all = TRUE)
eth2
goodHosp <- c("yyy", "uuu")
goodHosp
representative
typeof(representative)
representative <- as.list(as.data.frame(t(representative)))
representative
typeof(representative)
eth2 <- subset(eth, MAG.Id %in% representative, .keep_all = TRUE)
eth2
#ETH
representative <- as.data.frame(distinct(eth[13]))
representative <- representative %>%
separate(Representative.MAG, c("Rep", NA), ".fa")
representative <- as.list(as.data.frame(t(representative)))
eth <- subset(eth, MAG.Id %in% representative, .keep_all = TRUE)
eth <- eth %>%
select(1,4,5,10, 16)
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
eth <- eth %>%
mutate(Completeness = as.numeric(gsub(",",".",Completeness,fixed=TRUE)),
Contamination = as.numeric(gsub(",",".",Contamination,fixed=TRUE)),
N50 = as.numeric(gsub(",",".",N50,fixed=TRUE)))
eth$type <- "eth"
#ICM
icm <- icm %>%
select(1,4,14,15,22)
colnames(icm) <- c("ID", "Taxonomy", "Completeness", "Contamination", "N50")
icm$type <- "icm"
icm <- icm[-1,]
eth
eth <- read.csv("MAGs/ETH/MAGs_EMOSE_summary.fixed.csv", header = TRUE, sep = ";")
icm <- read.csv("MAGs/ICM/Mags_ICM_75.csv", header = TRUE, sep = ";")
#ETH
representative <- as.data.frame(distinct(eth[13]))
representative <- representative %>%
separate(Representative.MAG, c("Rep", NA), ".fa")
representative <- as.list(as.data.frame(t(representative)))
eth <- subset(eth, MAG.Id %in% representative, .keep_all = TRUE)
eth <- eth %>%
select(1,4,5,10, 16)
colnames(eth) <- c("ID", "Completeness", "Contamination", "Taxonomy", "N50")
eth <- eth %>%
mutate(Completeness = as.numeric(gsub(",",".",Completeness,fixed=TRUE)),
Contamination = as.numeric(gsub(",",".",Contamination,fixed=TRUE)),
N50 = as.numeric(gsub(",",".",N50,fixed=TRUE)))
#ICM
icm <- icm %>%
select(1,4,14,15,22)
colnames(icm) <- c("ID", "Taxonomy", "Completeness", "Contamination", "N50")
icm <- icm[-1,]
#ETH
ethmeanct <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethplotct <- ggplot(eth, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanct, col = "red") + ggtitle("ETH Completeness")
ethplotct
#ICM
icmmeanct <- sum(icm$Completeness)/nrow(icm)
icmplotct <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanct, col = "red") + ggtitle("ICM Completeness")
icmplotct
#ETH
ethmeanco <-  sum(as.numeric(eth$Contamination))/nrow(eth)
ethplotco <- ggplot(eth, aes(y = Contamination, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanco, col = "red") + ggtitle("ETH Contamination")
ethplotco
#ICM
icmmeanco <- sum(icm$Contamination)/nrow(icm)
icmplotco <- ggplot(icm, aes(y = Contamination, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanco, col = "red") + ggtitle("ICM Contamination")
icmplotco
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50 (no outliers)") + ylim(0, 100000)
icmplotres
icmmeanct
ethmeanct
ethmeanct
icmmeanct
#ETH
ethmeanct <-  sum(as.numeric(eth$Completeness))/nrow(eth)
ethplotct <- ggplot(eth, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeanct, col = "red") + ggtitle("ETH Completeness")
ethplotct
#ICM
icmmeanct <- sum(icm$Completeness)/nrow(icm)
icmplotct <- ggplot(icm, aes(y = Completeness, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeanct, col = "red") + ggtitle("ICM Completeness")
icmplotct
ethmeann
icmmeann
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50 (no outliers)") + ylim(0, 100000)
icmplotres
icm
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50 (no outliers)") + ylim(0, 100000) + facet_wrap(Taxonomy)
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50 (no outliers)") + ylim(0, 100000) + facet_wrap(icm$Taxonomy)
icmplotres
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50 (no outliers)") + ylim(0, 100000)
icmplotres
(sum(icm$N50)-25000)/nrow(icm)
icmmeann
(sum(icm$N50)-250000)/nrow(icm)
#ETH
ethmeann <-  sum(as.numeric(eth$N50))/nrow(eth)
ethplotn <- ggplot(eth, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = ethmeann, col = "red") + ggtitle("ETH N50")
ethplotn
#ICM
icmmeann <- sum(icm$N50)/nrow(icm)
icmplotn <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50")
icmplotn
icmplotres <- ggplot(icm, aes(y = N50, x = ID)) + geom_col() + theme(axis.text.x = element_blank()) + geom_hline(yintercept = icmmeann, col = "red") + ggtitle("ICM N50 (no outliers)") + ylim(0, 100000)
icmplotres
knit_with_parameters('C:/Users/Usuario/Desktop/Bioinformatica/Practicas/Practicas/Analysis/MAGs_comparisson.Rmd')
unlink('MAGs_comparisson_cache', recursive = TRUE)
